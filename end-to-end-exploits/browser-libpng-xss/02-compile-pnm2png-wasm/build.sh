#!/bin/bash
rm -r libpng-1.6.35 main.wasm main.js out/main.js out/main.wasm
unzip -q libpng-1.6.35.zip

source ../../../compilers/emcc-upstream/emsdk/emsdk_env.sh
emcc --bind -O2 main.cpp -o out/main.js -std=c++11 -s USE_LIBPNG=1 -s ALLOW_MEMORY_GROWTH=1 -s "EXTRA_EXPORTED_RUNTIME_METHODS=['ccall']"

./server.py